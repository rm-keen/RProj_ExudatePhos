"0","## 1. Get the order of horizons from your factor"
"0","h_levels <- levels(horizon_sub$HorizonFlip)"
"0",""
"0","## 2. Summarise to surface / subsurface per site"
"0","summ_surfsub <- horizon_sub %>%"
"0","  mutate(layer = case_when("
"0","    HorizonFlip %in% c(""O"", ""A"") ~ ""Surface"","
"0","    HorizonFlip %in% c(""B"", ""C"") ~ ""Subsurface"","
"0","    TRUE ~ NA_character_"
"0","  )) %>%"
"0","  filter(!is.na(layer)) %>%"
"0","  group_by(Location_knzmerge, layer) %>%"
"0","  summarise("
"0","    mean_eff = mean(OA_Efficiency * 100, na.rm = TRUE),"
"0","    se_eff   = sd(OA_Efficiency * 100, na.rm = TRUE) / sqrt(dplyr::n()),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  ## 3. Put surface between O/A, subsurface between B/C"
"0","  mutate("
"0","    x_pos = case_when("
"0","      layer == ""Surface""   ~ mean(match(c(""O"", ""A""), h_levels), na.rm = TRUE),"
"0","      layer == ""Subsurface""~ mean(match(c(""B"", ""C""), h_levels), na.rm = TRUE)"
"0","    )"
"0","  )"
"0",""
"0","# 3. Convert horizon from factor to numeric to place new layer averages between O/A and B/C"
"0","horizon_sub <- horizon_sub %>%"
"0","  mutate(h_num = as.numeric(HorizonFlip))"
