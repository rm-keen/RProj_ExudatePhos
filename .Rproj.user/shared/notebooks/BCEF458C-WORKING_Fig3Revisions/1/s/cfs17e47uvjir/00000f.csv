"0","# Horizon order and numeric positions"
"0","h_levels <- levels(horizon_sub$HorizonFlip)"
"0",""
"0","horizon_sub_2 <- horizon_sub %>%"
"0","  select(c(Location, SiteID, ProfileID, Location_knzmerge, "
"0","           HorizonFlip, OA_Efficiency, MA_Efficiency, AP_Efficiency))"
"0",""
"0","horizon_long <- horizon_sub %>%"
"0","  mutate("
"0","    hz_group = case_when("
"0","      HorizonFlip %in% c(""O"", ""A"") ~ ""Surface"","
"0","      HorizonFlip %in% c(""B"", ""C"") ~ ""Subsurface"","
"0","      TRUE ~ NA_character_"
"0","    ),"
"0","    h_num = as.numeric(HorizonFlip)"
"0","  ) %>%"
"0","  filter(!is.na(hz_group)) %>%"
"0","  pivot_longer("
"0","    cols = c(OA_Efficiency, MA_Efficiency, AP_Efficiency),"
"0","    names_to = ""Exudate"","
"0","    values_to = ""Eff"""
"0","  ) %>%"
"0","  mutate("
"0","    Eff_pct = Eff * 100,"
"0","    Exudate = factor("
"0","      Exudate,"
"0","      levels = c(""OA_Efficiency"", ""MA_Efficiency"", ""AP_Efficiency""),"
"0","      labels = c(""Oxalic acid"", ""Malic acid"", ""Acid phosphatase"")"
"0","    )"
"0","  )"
"0",""
"0",""
"0","pos_surface    <- mean(match(c(""O"", ""A""), h_levels), na.rm = TRUE)"
"0","pos_subsurface <- mean(match(c(""B"", ""C""), h_levels), na.rm = TRUE)"
"0",""
"0","summ_overall <- horizon_long %>%"
"0","  group_by(Exudate, hz_group) %>%"
"0","  summarise("
"0","    mean_eff = mean(Eff_pct, na.rm = TRUE),"
"0","    sd_eff = sd(Eff_pct, na.rm = TRUE),"
"0","    se_eff   = sd(Eff_pct, na.rm = TRUE) / sqrt(dplyr::n()),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  mutate("
"0","    x_pos = if_else(hz_group == ""Surface"", pos_surface, pos_subsurface)"
"0","  )"
